# VeriPix â€“ AI Image Forgery Detection and Localization

![VeriPix Banner](images/Gemini_Generated_Image_hxz3u6hxz3u6hxz3.png)

**VeriPix** is a deep learning-based system designed to detect and localize digital image forgeries. It utilizes **Error Level Analysis (ELA)** for preprocessing, **EfficientNet** for binary classification, and a **U-Net** architecture for generating pixel-level tampering masks.

## ðŸš€ Features

* **Binary Classification:** accurate detection of images as **Authentic** or **Tampered**.
* **Pixel-Level Localization:** Generates segmentation masks to pinpoint manipulated regions.
* **ELA Preprocessing:** Highlights JPEG compression artifacts and inconsistencies introduced by editing tools.
* **Interactive Web App:** Built with **Gradio** for real-time demonstrations and easy interaction.
* **Training Monitoring:** Integrated **TensorBoard** logging for tracking loss curves and metrics.
* **Dataset Support:** Compatible with industry-standard datasets like **CASIA v2** and **CoMoFoD**.

---

## ðŸ“‚ Project Structure

```text
VeriPix/
â”œâ”€â”€ config.yaml                     # Global configuration (paths, hyperparameters, losses)
â”œâ”€â”€ scripts/                        # Utility scripts
â”‚   â””â”€â”€ prepare_data.py             # Script to generate train/val/test splits
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                        # Original datasets (CASIA, CoMoFoD)
â”‚   â”œâ”€â”€ processed/                  # Train/val/test splits (generated by script)
â”‚   â””â”€â”€ masks/                      # Ground truth masks
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ efficientnet_classifier.py  # EfficientNet-based binary classifier
â”‚   â””â”€â”€ unet_localizer.py           # U-Net based localization model
â”œâ”€â”€ preprocessing/
â”‚   â””â”€â”€ ela.py                      # Error Level Analysis implementation
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ dataset.py                  # Custom PyTorch dataset and dataloaders
â”‚   â””â”€â”€ advanced_augmentations.py   # Data augmentation pipelines
â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ train_classifier.py         # Training loop for classifier
â”‚   â”œâ”€â”€ train_localizer.py          # Training loop for localizer
â”‚   â””â”€â”€ losses.py                   # Loss functions (BCE, Dice, Focal, etc.)
â”œâ”€â”€ evaluation/
â”‚   â””â”€â”€ evaluate.py                 # Metrics calculation (Acc, F1, AUC, IoU, Dice)
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ gradio_app.py               # Full web interface (Classification + Localization)
â”‚   â””â”€â”€ gradio_app_classifier_only.py
â”œâ”€â”€ checkpoints/                    # Saved model weights
â”œâ”€â”€ logs/                           # TensorBoard logs
â””â”€â”€ results/                        # Output plots (Confusion Matrix, ROC, etc.)
```

## Setup & Installation

### 1. Clone and Environment
Clone the repository and create a virtual environment.
```bash
git clone <your-repo-url> VeriPix
cd VeriPix

# Create virtual environment
python -m venv venv

# Activate environment
source venv/bin/activate        # macOS/Linux
# venv\Scripts\activate         # Windows

# Install dependencies
pip install -r requirements.txt
```

Key requirements:
```text
 torch, torchvision, timm, albumentations, opencv-python, Pillow, numpy, scikit-learn, tensorboard, gradio.
```

### 2. Download Datasets
Download the following datasets and place them in ```data/raw/```

CASIA v2.0 Image Tampering Detection Dataset

CoMoFoD (Color Image Forensics Dataset)

### 3. Data Preprocessing
Run the preparation script to generate unified train/val/test splits and process masks.
```bash
python scripts/prepare_data.py
```

## Training
All hyperparameters (epochs, batch size, optimizer) are controlled via ```config.yaml```.

### 1. Train Classifier (EfficientNet)
Trains the binary classifier to distinguish between authentic and tampered images.

```bash
python training/train_classifier.py --epochs 60
```
Input: ELA Images
Metrics: Accuracy (~90â€“95%), F1-Score (0.89â€“0.95), AUC-ROC (~0.97)
Logs: ```logs/classifier/```

### 2. Train Localizer (U-Net)
Trains the segmentation model to create a mask of the forged area.

```bash
python training/train_localizer.py --epochs 70
```
Input: ELA Images
Loss: Focal-Dice or Dice+BCE (handles class imbalance)
Metrics: IoU (0.2â€“0.7 depending on dataset difficulty), Dice Score

Logs: ```logs/localizer/```

### 3. Monitor with TensorBoard
```bash
tensorboard --logdir logs
```

## Evaluation
After training, evaluate the models on the test set to generate metrics and plots.

```bash
python evaluation/evaluate.py
```
Outputs in results/:
Confusion Matrix & ROC Curve
Classification Metrics: Accuracy, Precision, Recall, F1, AUC

Localization Metrics: IoU, Dice, Pixel Accuracy

## Gradio Web App
VeriPix includes an interactive GUI for demonstrations.

Full System (Classification + Localization)
```bash
python gui/gradio_app.py --port 7860
```
Visit:``` http://localhost:7860```

Features:
Upload any image.
Classification: Label (Authentic/Tampered) + Confidence Score.
Visuals: Green/Red border indicator and Heatmap overlay.
Localization: Binary mask highlighting the forged region.
Classifier-Only Demo
```bash
python gui/gradio_app_classifier_only.py --port 7861
```

## Technical Details
### Workflow:
* ELA Preprocessing: Converts RGB input to an Error Level Analysis map (JPEG quality 90, scale 10).
* Classifier: EfficientNet-B0 (or B4 via timm) predicts the global label.
* Localizer: U-Net encoder-decoder predicts pixel-wise tampering probability.

### Loss Functions:
* Classification: BCE, Weighted BCE, Focal Loss.
* Localization: Dice, Tversky, Focal-Dice, Combo Loss.
* Normalization: Images resized to 224x224 and normalized using ImageNet statistics.

###  Future Work
* **Architecture Upgrade:** Replace standard U-Net with Attention U-Net or DeepLabV3+ to improve IoU.
* **Ensembling:** Use an ensemble of EfficientNet variants to push accuracy >97%.
* **Datasets:** Add support for MICC-F2000 and Coverage datasets.
* **Explainability:** Integrate Grad-CAM to visualize classifier attention maps.
